// LeetCode: Biggest Window Between Visits (biggest-window-between-visits)
// Submission ID: 1762350123
// Language: mysql
// Timestamp (UTC): 2025-09-07T06:47:24Z

# Write your MySQL query statement below
select user_id,
max(datediff(next_date,visit_date))as biggest_window
from(
    select user_id,
    visit_date,
    lead(visit_date,1,'2021-01-01') 
    over(partition by user_id order by visit_date) as next_date
    from UserVisits
) a
group by user_id